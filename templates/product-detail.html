{% extends 'base.html' %}
{% load static %}
{% load mathfilters %}
{% load custom_filters %}
{% load humanize %}
{% load i18n %}

{% block head_title %}
						{% if LANGUAGE_CODE == 'ar'  %}
						{{object.title_ar}}
						{% elif  LANGUAGE_CODE == 'en' %}
						{{object.title_en}} 
						{% else %}
						{{object.title}} 
						{% endif %}
{% endblock %}
{% block content %}

	<!-- breadcrumb -->
	<div class=" {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %} bread-crumb bgwhite flex-w p-l-52 p-r-15 p-t-30 p-l-15-sm">
		<a href="/">
			<i class="d-icon-home chemin"></i>
			<i class="fa fa-angle-{% if LANGUAGE_CODE == 'ar' %}left{% else %}right{% endif %} m-l-8 m-r-9" aria-hidden="true"></i>
		</a>
		<a href="/" class="s-text16">
			{% trans 'Home' %}
			<i class="fa fa-angle-{% if LANGUAGE_CODE == 'ar' %}left{% else %}right{% endif %} m-l-8 m-r-9" aria-hidden="true"></i>
		</a>

		<a href="{% url 'core:category' object.category.slug %}" class="s-text16">
			
			{% if LANGUAGE_CODE == 'ar'  %}
			{{ object.category.title_ar }}
						{% elif  LANGUAGE_CODE == 'en' %}
						{{ object.category.title_en }}
						{% else %}
						{{ object.category }}
						{% endif %}
			<i class="fa fa-angle-{% if LANGUAGE_CODE == 'ar' %}left{% else %}right{% endif %} m-l-8 m-r-9" aria-hidden="true"></i>
		</a>

		<span class="s-text17">
			{% if LANGUAGE_CODE == 'ar'  %}
						{{object.title_ar}}
						{% elif  LANGUAGE_CODE == 'en' %}
						{{object.title_en}} 
						{% else %}
						{{object.title}} 
						{% endif %}
		</span>
	</div>

	<!-- Product Detail -->
	<div class="container bgwhite p-t-35 p-b-80">
		<div class="flex-w flex-sb">
			<div class="w-size13 p-t-30 respon5">
				<div class="wrap-slick3 flex-sb flex-w">
					
					<div class="product-thumbs-wrap breadcrumb-lg d-none d-lg-block d-xl-none">
						<div class="product-thumbs " style="top: 0px;" >

							<div class="product-thumb ">
								<img src="{{ object.image.url }}" loading="lazy" alt="product thumbnail" width="109" height="122">
							</div>
							{% for image in images %}
							<div class="product-thumb ">
								<img src="{{ image.image.url }}" loading="lazy" alt="product thumbnail" width="109" height="122">
							</div>
							{% endfor %}
						</div>
						<button class="thumb-up disabled"><i class="fas fa-chevron-left"></i></button>
						<button class="thumb-down"><i class="fas fa-chevron-right"></i></button>
						<script>
							

							var thumdown = document.getElementsByClassName("thumb-down")[0]

							document.getElementsByClassName("thumb-down")[0].addEventListener("click",function(){
								var childrennum= document.getElementsByClassName("product-thumbs")[0].children.length
								var topval= document.getElementsByClassName("product-thumbs")[0].style.top.replace("px","")
								if(125*(childrennum-4)>parseInt(topval)*(-1)){
									document.getElementsByClassName("product-thumbs")[0].style.top = -100 + parseInt(topval) +"px"
									var thumup = document.getElementsByClassName("thumb-up")[0]

									if(parseInt(topval) -100 < 0){
									thumup.classList.remove("disabled")

										}else{
											thumup.classList.add("disabled")
										}
								}else{
									thumdown.classList.add("disabled")
								}
								
								
									
								
							})
							var thumup = document.getElementsByClassName("thumb-up")[0]


							document.getElementsByClassName("thumb-up")[0].addEventListener("click",function(){
								var topval= document.getElementsByClassName("product-thumbs")[0].style.top.replace("px","")
								var childrennum= document.getElementsByClassName("product-thumbs")[0].children.length
								var thumdown = document.getElementsByClassName("thumb-down")[0]

								if(parseInt(topval) < 0){
									document.getElementsByClassName("product-thumbs")[0].style.top = +100 + parseInt(topval) +"px"
									
									if(parseInt(topval) -100 < 0){
										thumdown.classList.remove("disabled")
										
									}else{
										thumdown.classList.add("disabled")
									}
								}else{
									thumup.classList.add("disabled")
								}
								
								
							})


							
						</script>
						
					</div>

					<div class="slick3">
						<div class="item-slick3" data-thumb="{{ object.image.url }}">
							<div id="img-container" class="wrap-pic-w">
								<div id="lens"></div>	
								<a data-lightbox="photo" href="{{ object.image.url }}">

									<img id="featured" src="{{ object.image.url }}" alt="{{ object.title }}">
									<script>
										document.getElementById('featured').onerror = function() {
											document.getElementById('featured').src="/static/images/product-def.png";  
											// ele.style.height=348 + "px"
										};
									</script>
								</a>
 								
									 							 
							</div>
						</div>
					{% for image in images %}
						
					<div class="item-slick3" data-thumb="{{image.image.url}}">
						<div class="wrap-pic-w">
							<img src="{{image.image.url}}" alt="IMG-PRODUCT">
						</div>
					</div>

					{% endfor %}
<script>
	document.querySelectorAll(".product-thumb ").forEach(ele=>{
		ele.children[0].onerror = function() {
            ele.remove(); // Hide the image if it doesn't exist
			
        };
		if(ele.nextElementSibling.children[0].src == ele.children[0].src){
			ele.remove();
		}
	})
</script>
						 
					</div>
				</div>
			</div>

			<!-- <div class="w-size14 p-t-30 respon5">
				<h4 class="product-detail-name m-text16 p-b-13">
					{{object.title}}
				</h4>

				
				{% if object.discount_price %}
								<span class="block2-oldprice m-text7 p-r-5" style="font-size: 1.5rem;">
									${{ object.price }}
								</span>

								<span class="block2-newprice m-text8 p-r-5" style="font-size: 1.5rem;">
									${{ object.discount_price }}
								</span>
								{% else %}
								<span class="m-text17">
									${{object.price}}
								</span>
								{% endif %}

				<p class="s-text8 p-t-10">
					{{ object.description_short }}
				</p>

				<!--  -->
				<div class="product-details" style="width: 50%;">
					<div id="img_lens_zoom" class="img_lens_zoom" >
		
					</div>
						
							
									
						
						
					<h1 class="product-name name-title {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %} ">
						{% if LANGUAGE_CODE == 'ar'  %}
						{{object.title_ar}}
						{% elif  LANGUAGE_CODE == 'en' %}
						{{object.title_en}} 
						{% else %}
						{{object.title}} 
						{% endif %}
					</h1>

					
					<div class="product-price price-detail d-none d-lg-block d-xl-none {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">
						{% if object.price > object.discount_price %}
										<del class="old-price old-price-block">&nbsp;{{object.price}} {% trans 'DA' %}</del>
										 &nbsp; 
										<ins class="new-price price-block">{{object.discount_price}}{% trans 'DA' %}</ins>
										{% else %}

										<ins class="new-price price-block">{{object.price}}{% trans 'DA' %}</ins>
						{% endif %}
					</div> 

					<div class="ratings-container price-detai {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">
						 
						<div class="ratings-full">
							<style>
								.ratings{
									width: {%  widthratio object.rating  0.05 1 %}%;
								}
							</style>
							<span class="ratings " ></span>
							<span class="tooltiptext tooltip-top">{{object.rating}}</span>
						</div>
						<a href="#product-tab-reviews" class="link-to-tab rating-reviews">( {{comments|length}} {% trans 'Avis' %} )</a>
						
						<img src="/static/images/VSC.svg" class="head-heart" style="width:30px; height:30px;">
						<a href="#product-tab-reviews" class="link-to-tab rating-reviews">{{object.wishlist_num|floatformat:0}}</a>
					</div>
					
					
					
					{% if object.has_coupon and object.show_coupon %}
						<div class="owl-stage-outer {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">
							<div class="owl-item active" style="width: 280px; margin-right: 20px;">
								<div class="icon-box  icon-box-side flex-column coupon-box">
										<div class="icon-box-content mb-1 text-center">
											<div class="row">
												<div class="col-3">
													<i class="icon-box-icon  d-icon-card"></i> 
												</div>
												<div class="col-8">
													<h4 class="icon-box-title text-uppercase">{% if not LANGUAGE_CODE == 'ar' %}{{object.price_after_coupon|mul:100|div:object.price|sub:100|floatformat:1}}% {%endif %} {% trans "Tu viens d'arriver ? Profite de" %}
														{{object.price_after_coupon|mul:100|div:object.price|sub:100|mul:-1|floatformat:1}}% {% trans 'de réduction' %}</h4>
												</div>
											</div>
											<p style="color:#000;">{% trans 'avec le code :' %}   <span style="font-weight:600;"> {{object.coupon_code}} </span></p>
										</div>
								</div>
							</div> 
						</div> 
					{% endif %}
					

					 


							{% if colors_item|length > 1 %}
								<p class="{% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}" > {% trans 'Couleurs' %} : </p>
								 

									
											
								<div class="{% if LANGUAGE_CODE == 'ar' %}rtl{% endif %} owl-carousel555 owl-theme owl-nav-inner mb-10 pb-6 appear-animate owl-loaded owl-drag fadeIn appear-animation-visible" data-animation-options="{'name': 'fadeIn'}" data-owl-options="{
									'nav': false,
									'dots': false,
									'margin': 0,
									'responsive': {
										'0': {
											'items': 5
										},
										'576': {
											'items': 5
										},
										'768': {
											'items': 5
										},
										
										'992': {
											'items': 9
										}
									}
								}" style="animation-duration: 1.2s;">
									
								
								<div class="owl-stage-outer" style="overflow: hidden;">
									<div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); 
									transition: all 3s ease 0s; width: 5814px;">
								{% for item in colors_item %}
								
								<div class="product-mediaitm owl-item new_item {% if forloop.counter == 1 %} margin-right-2 {% endif %} {% if forloop.counter <= 4 %} active{% endif %}" style="width: 247px !important; margin-right: 20px;">
									<a class="variant" >
											 
										<img draggable="false" style="width: 50px !important; height: 100% !important;" class="color variant-owl" src="{{item.image.url}}"
										 alt=" " data-slug="{{item.slug}}" data-current="{{object.slug}}"  srcset="" loading="lazy" width="80">
									</a>
								</div> 
								{% endfor %}
								
								<script>
									document.querySelectorAll(".product-mediaitm").forEach(ele=>{
										ele.children[0].children[0].onerror = function() {
											ele.children[0].children[0].src="/static/images/product-def.png";  
											// ele.style.height=348 + "px"
										};
										 
									})
								</script>
									</div>
								</div>
								
								 
					
							</div>
							<script>
								$(document).ready(function(){
								  $(".owl-carousel555").owlCarousel({
									items: 9, // Display 4 items in a line
									loop: false,
									margin: 0,
									nav: false,
									dots: false,
									responsive: {
									  0: {
										items: 5 // Display 1 item on smaller screens
									  },
									  600: {
										items: 5 // Display 2 items on screens wider than 600px
									  },
									  992: {
										items: 9 // Display 4 items on screens wider than 1000px
									  }
									}
								  });
								});
							  </script>			
								 
									 
								
							{% endif %}
							<script>

								 // Get all the anchor tags with the class "item-link"
    const itemLinks = document.querySelectorAll('.variant');

// Add a click event listener to each anchor tag
itemLinks.forEach(itemLink => {
	itemLink.addEventListener('click', (event) => {

		var slug_clicked = event.target.dataset.slug
		var slug_current = event.target.dataset.current
		
		var new_pth = window.location.pathname.replace(slug_current,slug_clicked)
		
		window.location.pathname = new_pth
		// Prevent the default anchor click behavior (optional)
		event.preventDefault();

		// Get the image element inside the clicked anchor tag
		const clickedImage = itemLink.querySelector('.variant-owl');

		// Remove the 'active' class from all images
		const allImages = document.querySelectorAll('.variant-owl');
		allImages.forEach(image => {
			image.classList.remove('variant-owl-active');
		});

		// Add the 'active' class to the clicked image
		clickedImage.classList.add('variant-owl-active');
	});
});

							
							</script>
							 
								<div class="product-form product-size {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %} ">
									<div class="product-form-group product-cen">
										<div class="product-variations">
											<div class="d-flex justify-content-between">
												<label style="font-size:16px">{% trans 'Taille' %}</label>  <br>
												
											</div>	 
											
											
												
											
											<script>
												var mysize="{{object.size_exist}}"
												var splitedsize= mysize.split(",")
												var sizes_not = "{{object.size_not_exist}}"
												var splitedsizenot= sizes_not.split(",")
												var stickysizes=document.getElementById("sticky_sizes")

												// Extract all labels with class "variant__button__label" into an array
									const labels = splitedsize.concat(splitedsizenot)
								 
								// Extract the text content of each label and store it in a separate array
								const labelTexts = labels.map(label => label);
							
								// Sort the text values (assuming they contain both numbers and strings)
								labelTexts.sort((a, b) => a.localeCompare(b, undefined, { numeric: true }));
							
								  
												for(var append_size=0; append_size < labelTexts.length;append_size++){
													if(! splitedsizenot.includes(labelTexts[append_size])){
														document.write(
														`<div class="d-inline-block text-center dot-wrapper taille__wrapper mr-2 mr-lg-0">
														<input id="stock-${append_size+1}" class="variant-input visually-hidden" type="radio" name="atribute" required="" value="${append_size+1}">
														<label style="line-height: 2.7rem;" class="variant__button__label" for="stock-${append_size+1}">
															${labelTexts[append_size]} 
														</label> 
														 
														</div>`
													)
													}else{

														if( labelTexts[append_size] != "nan"){
															document.write(
														`<div class="d-inline-block text-center dot-wrapper taille__wrapper mr-2 mr-lg-0 barred">
														<input id="stock-${append_size+1}"  class="variant-input visually-hidden" type="radio" name="atribute" disabled="true" >
														<label  style="line-height: 2.7rem;" class="variant__button__label" for="stock-${append_size+1}"  style="color:#d5b2b2a8  !important">
															${labelTexts[append_size]} 
														</label> 
														<div class="notice-alarm"><div class="i-notice-alarm"></div></div>
														
														</div>`
													)
														}

														
													}
 												}

											
												
												
											</script>  
										
										
												
											
										</div>
									</div>
								</div>
								 
								
								  
								
						
							<div class="product-form product-qty d-md-block d-lg-block d-xl-block d-xs-none">
							
								<label style="display: none;">Quantité :</label>
								<div class="product-form-group product-cen {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %} ">
									<div class="input-group" style="display: none;">
										<button class="btn-num-update-product-down d-icon-minus"></button>
											<input type="number" name="quantity" class="quantity form-control" value="1" required="">
										<button class="btn-num-update-product-up d-icon-plus"></button>
									</div>
									<a id="submit_to" style="width: 76%;" href="/add-to-cart/{{object.slug}}?name=dd">
										<button  style="width: 100%;" type="submit" class="btn-product btn-cart"><i class="d-icon-bag" style="color:#fff;"></i>
											
											{% trans 'Ajouter Au Panier' %}
										</button> 
									</a>
									
								<a class="{% if LANGUAGE_CODE == 'ar' %}margin-right-30{% endif %} sticky-wishlist-th d-md-none d-lg-block d-xl-block  d-xs-none" 
									id="wishHeart" 
									href="/wishlist-add/{{object.slug}}">
									 
									{% if whished %}
									<img src="/static/images/PSC.svg">
									{% else %}
									<img src="/static/images/VSC.svg">

									{% endif %}
								</a>
									
									
								 </div> 
							</div>							
					</form>
					<div class="mobile_cart"  >
						<a id="submit_to" style="width: 76%;" href="/add-to-cart/{{object.slug}}?name=dd">
																<button style="width: 100%;" type="submit" class="btn-product btn-cart"><i class="d-icon-bag" style="color:#fff;"></i>
																	{% trans 'Ajouter Au Panier' %}
																</button> 
															</a>
						
						<a  class="{% if LANGUAGE_CODE == 'ar' %}margin-right-30{% endif %} sticky-wishlist-th d-md-none d-lg-block d-xl-block  d-xs-none" id="wishHeart" 
						href="/wishlist-add/{{object.slug}}" 
						style="display: block !important;height: 100%;height: 40px;">
						{% if whished %}
						<img src="/static/images/PSC.svg" style="height: 100%"  >
						{% else %}
						<img src="/static/images/VSC.svg" style="height: 100%;">

						{% endif %}
					
					</a>
									
						</div>
						<hr class="product-divider  mb-3 hr-product">
						<div class="product-footer {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">
							<div class="social-links mr-4 ">
								<p class="{% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}"> <span style="color:#000"> {% trans 'Délais de livraison' %} :</span> 
									{% if object.shipping|extract_numbers %}
									{{object.shipping|extract_numbers}} 
									{% if  object.shipping|extract_numbers == '1' %}
									{% trans 'jour' %}
									{% else %}
									{% trans 'jours' %}
									{% endif %}
									{% else %}
									{% trans 'le meme jour' %}
									{% endif %} 
								</p>
								
								
							</div> 
							
							
							
							
							
							<div class="product-action">
								
								
								
							</div>
						</div>
				</div>
					<div class="sticky-content-wrapper" style="height: 67px;">
						<div   class="sticky-content  product-sticky-content navWrap fixed" 
							style="padding-top: 0px;opacity: 0;  height: 67px;top: -67px; margin-top: 0px; z-index: 1060;">
							 
							<input type="hidden" name="csrfmiddlewaretoken" value="AVg2LaTGIt7mBFL7aXM68glmYxpnptul1hepXqZ0c8RwmGFt8WR0enfQubiNYq9O">
							<div class="container">  
								<div class="sticky-product-details d-sm-block">
										<figure class="product-image">
											<img src="{{ object.image.url }}" alt="Manteau Beige en Laine image" class="sticky-image mr-3" loading="lazy">
										</figure>
									<div class="title-sticky-div">
										<h4 class="product-title sticky-title"><a href="#">
											{% if LANGUAGE_CODE == 'ar'  %}
											{{object.title_ar}}
											{% elif  LANGUAGE_CODE == 'en' %}
											{{object.title_en}} 
											{% else %}
											{{object.title}} 
											{% endif %}
										</a></h4>
										<div class="product-info sticky-p-info">
											<div class="product-price ">
												{% if object.discount_price > object.price%}
												<ins class="new-price new-price-sticky">{{object.price}} {% trans 'DA' %}</ins>
												
												<del class="old-price-sticky"> &nbsp;1 {% trans 'DA' %}</del>
											
												{% else %}
												<ins class="new-price new-price-sticky">{{object.price}} {% trans 'DA' %}</ins>
												

												{% endif %}
											</div>
										</div>
									</div>
								</div>
								<div class="product-form product-qty" style="padding-top: 3.5px;">
									<div class="product-form-group">
										<div class="product-form product-size sticky_div" style="margin-left:55rem;padding-right: 10px;">
											
												<div class="product-form product-size d-flex justify-content-end" style="margin-right: 8px;">
													<div class="select-box sticky-selct-box">
														<select name="atribute" value="" class="form-control" id="sticky_sizes" required="required">
															<option value="">{% trans 'Taille' %} </option>
															
														<script>
															var mysize="{{object.size_exist}}"
															var splitedsize= mysize.split(",")
															var stickysizes=document.getElementById("sticky_sizes")
															splitedsize = splitedsize.map(label => label);
							
															// Sort the text values (assuming they contain both numbers and strings)
															splitedsize.sort((a, b) => a.localeCompare(b, undefined, { numeric: true }));
														
															for(var append_size=0; append_size < splitedsize.length;append_size++){
																document.write(
																	`<option id="stock-${append_size+1}" name="atribute" value="${splitedsize[append_size]}">${splitedsize[append_size]}</option>`
																)
																 
															}

															document.getElementById('sticky_sizes').addEventListener("change",function(){
																	const targetid_op =this.options[this.options.selectedIndex].id
																	document.getElementById(targetid_op).checked=true
															})
														</script>
															
															 
															
														</select>
													</div>
												</div> 
												
											<input type="number" style="display: none;" name="quantity" class="quantity form-control display-none" value="1" required="">
												<a id="submit_to" href="/add-to-cart/{{object.slug}}?name=dd">
													<button type="submit" class="btn-product btn-cart sticky-bag"><i class="d-icon-bag" style="color:#fff;"></i>
														{% trans 'Ajouter Au Panier' %}
													</button>
												</a>
											<a class="sticky-wishlist-th" id="wishHeart"
											 href="/wishlist-add/{{object.slug}}" 
											 >
											 {% if whished %}
											 <img src="/static/images/PSC.svg">
											 {% else %}
											 <img src="/static/images/VSC.svg">
		 
											 {% endif %}
											
											</a>
										</div>
									</div>
								</div>
							</div>
						 
						</div>
					</div>
				<br>
				 
				 

			 

				
			</div> 
		</div>
	</div>

	<div class="tab tab-nav-simple product-tabs pt-4"  style="padding: 8px;min-height:50vh;width: 85.5%;margin: auto;">
		<ul class="nav nav-tabs d-flex justify-content-center {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}" style="width:auto;" role="tablist">
			<li class="nav-item mr-auto ml-auto">
				<a class="nav-link navvlink active" style="text-decoration: none;background: none;" href="#product-tab-description">{% trans 'Déscription' %}</a>
			</li>
			<li class="nav-item mr-auto ml-auto">
				<a class="nav-link navvlink" style="text-decoration: none;background: none;" href="#product-tab-additional">{% trans 'Caractéristiques' %}</a>
			</li>					
		</ul>
		<div class="tab-content">
			<div class="tab-pane active in {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}  " id="product-tab-description" >
					{% if LANGUAGE_CODE == 'ar'  %}
					{{object.description_long_ar|linebreaks}}
					{% elif  LANGUAGE_CODE == 'en' %}
					{{object.description_long_en|linebreaks}}
					{% else %}
					{{object.description_long|linebreaks}}
					{% endif %}
				
			</div>
			<div class="tab-pane " id="product-tab-additional" style="min-height: 250px;">
				<ul class="detail-attr-container">
					
					{% for key, value in details.items %}
					 
							 
							{% if value != nan %}
								<li  class="detail-attr-item">
									<span>{{key}}</span> 
									<span><b id="{{ key|slugify }}">{{value}}</b></span>
								</li>
								<script>
									var element = document.getElementById("{{ key|slugify }}");
									if (element.innerHTML == "nan" || element.innerHTML =="NULL") {
										element.parentElement.parentElement.remove()
									}
									if("{{value}}" == "Couleur"){
										document.querySelector(".detail-attr-container ").classList.add("rtl")
									}
								</script>
							{% endif %}
					 
					{% endfor %}
				 
				</ul>
			</div>
			<script>
				Array.from(document.querySelectorAll(".nav-link")).forEach(tab=>{
					tab.addEventListener("click",function(){
						 
						$(this).addClass("active")
						$(this).parent().siblings().children("a").removeClass("active")

						var detid=tab.href.split("#")[tab.href.split("#").length-1]
						$(document.getElementById(detid)).addClass("active in")
						$(document.getElementById(detid)).siblings().removeClass("active in")
						
					})
				})
			</script>
		</div>
	</div>
	<!-- Relate Product -->
	{% if relate_pros %} 
	<section class="relateproduct bgwhite p-t-5 p-b-138" style="overflow: hidden;width: 98%; margin: auto;">
		<div class="container">
			<div class="sec-title   p-t-40">
				<h2 class="m-text5 {% if LANGUAGE_CODE == 'ar' %}rtl marg-right-10{% endif %} ">
					{% trans 'Related Products' %}
				</h2>
			</div>
			<div class="owl-carousel551 owl-theme owl-nav-inner mb-10 pb-6 appear-animate owl-loaded owl-drag fadeIn appear-animation-visible" data-animation-options="{'name': 'fadeIn'}" data-owl-options="{
				'nav': true,
				'dots': true,
				'margin': 20,
				'responsive': {
					'0': {
						'items': 2
					},
					'576': {
						'items': 2
					},
					'768': {
						'items': 2
					},
					
					'992': {
						'items': 4
					},
					'1200': {
						'items': 5
					}
				}
			}" style="animation-duration: 1.2s;">
				
			
			<div class="owl-stage-outer">
				<div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); 
				transition: all 3s ease 0s; width: 5814px;">
			{% for new_item in relate_pros %}
			
			<div class="owl-item new_item{% if forloop.counter <= 4 %} active{% endif %}" style="width: 247px !important; margin-right: 20px;">
				<div class="product product-classic">
				<figure class="product-media">
				<a href="/product/{{new_item.slug}}">
					
						<img style="width: 100%; height: 100%;" src={{new_item.image.url}} loading="lazy" alt="Manteau Noir  Oversize en Laine  image" width="300" height="338">
					
				</a>
				{% if LANGUAGE_CODE ==  'ar'  %}
			<div class="product-action-vertical" style="right: 78% !important;">
	 
			<a id="wishHeart" hx-get="/fr/wishlistadd/873" hx-target="this" hx-swap="outerHTML" class="btn-product-icon btn-wishlist" title="Ajouter à la liste de souhait">
				<img src="/static/images/VSC.svg">
			</a>		
			</div>
			<div class="product-label-group" style="width: 48px;position: absolute !important;
			right: 0px !important;
			top: 30px  ;left: auto !important;">
				
					
					<label style="width: 100%;" class="product-label label-top">{% trans new_item.get_label_display %}</label>

			</div>  

			{% else %}
			<div class="product-action-vertical">
	 
				<a id="wishHeart" hx-get="/fr/wishlistadd/873" hx-target="this" hx-swap="outerHTML" class="btn-product-icon btn-wishlist" title="Ajouter à la liste de souhait">
					<img src="/static/images/VSC.svg">
				</a>		
				</div>
				<div class="product-label-group">
					
						
						<label class="product-label label-top">{% trans new_item.get_label_display %}</label>
	
				</div>  

			{% endif %}
</figure>
<div class="product-details">
	
<h3 class="product-name {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">
	<a href="/product/{{new_item.slug}}">
		
						{% if LANGUAGE_CODE == 'ar'  %}
						{{new_item.title_ar}}
						{% elif  LANGUAGE_CODE == 'en' %}
						{{new_item.title_en}} 
						{% else %}
						{{new_item.title}} 
						{% endif %}
						  </a>
</h3>
<div class="product-price d-flex justify-content-between {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">
	<div>
		
		{% if new_item.price > new_item.discount_price %}
		<del class="old-price old-price-block">&nbsp;{{new_item.price}} {% trans 'DA' %}</del>
		 &nbsp; 
		<ins class="new-price price-block">{{new_item.discount_price}}{% trans 'DA' %}</ins>
		{% else %}

		<ins class="new-price price-block">{{new_item.price}}{% trans 'DA' %}</ins>
{% endif %}
	</div>
	
</div>


</div>
</div>
			</div> 
			{% endfor %}


				</div>
			</div>
			
			<!-- Slide2 -->
			<!-- <div class="wrap-slick2">
				<div class="slick2">

					  {%for rel_pro in relate_pros %}
					
					<div class="item-slick2 p-l-15 p-r-15">
						 
						<div class="block2">
							<div class="block2-img wrap-pic-w of-hidden pos-relative block2-labelnew">
								<img src="{{rel_pro.image.url}}" alt="IMG-PRODUCT">

								<div class="block2-overlay trans-0-4">
									<a href="#" class="block2-btn-addwishlist hov-pointer trans-0-4">
										<i class="icon-wishlist icon_heart_alt" aria-hidden="true"></i>
										<i class="icon-wishlist icon_heart dis-none" aria-hidden="true"></i>
									</a>

									<div class="block2-btn-addcart w-size1 trans-0-4">
									 
										<button class="flex-c-m size1 bg4 bo-rad-23 hov1 s-text1 trans-0-4">
											Add to Cart
										</button>
									</div>
								</div>
							</div>

							<div class="block2-txt p-t-20">
								<a href="/product/{{rel_pro.slug}}" class="block2-name dis-block s-text3 p-b-5">
									{{rel_pro.title}}
								</a>

								<span class="block2-price m-text6 p-r-5">
									${{rel_pro.price}}
								</span>
							</div>
						</div>
					</div>


					{% endfor %}  
				</div>
			</div> -->

		</div>
		<script>
			$(document).ready(function(){
			  $(".owl-carousel551").owlCarousel({
				items: 5, // Display 4 items in a line
				loop: false,
				margin: 20,
				nav: true,
				dots: true,
				responsive: {
				  0: {
					items: 2 // Display 1 item on smaller screens
				  },
				  600: {
					items: 2 // Display 2 items on screens wider than 600px
				  },
				  992: {
					items: 4 // Display 4 items on screens wider than 1000px
				  },
				  1200: {
					items: 5 // Display 4 items on screens wider than 1000px
				  }
				}
			  });
			});
		  </script>
		  <script>
			document.querySelector('.sticky-image').onerror = function() {
				document.querySelector('.sticky-image').src="/static/images/product-def.png";  
					 
				};
			document.querySelectorAll(".product-media").forEach(ele=>{
				ele.children[0].children[0].onerror = function() {
					ele.children[0].children[0].src="/static/images/product-def.png";  
					ele.style.height=348 + "px"
				};
				 
			})
		</script>
	</section>
	{% endif %}
	<div style="padding: 10px;" class="tab tab-nav-simple product-tabs pt-4">
		<ul class="nav nav-tabs justify-content-center" style="width:auto;" role="tablist">
			<li class="nav-item">
				<a style="background: none;border-bottom: 3px solid transparent !important;
				border-bottom-color: transparent;
			  border-bottom-color: transparent !important;
			  background-color: transparent;
			  border-bottom-color: #222 !important;" class="nav-link active" href="#product-tab-reviews">{% trans 'Avis' %} ({{comments|length}})</a> 
			</li>
		</ul>     
		<div class="tab-content">
		
			<div class="tab-pane active in" id="product-tab-reviews">
				<div class="comments mb-8 pt-2 pb-2 border-no">
					<ul>
						{% for comment in comments %}
						<li>
							<div class="comment">
										<figure class="comment-media">
											{% if comment.user.profile %}
											 
												 <img style="border-radius: 50%;" src="{{comment.user.profile.image.url}}" alt="photo" loading="lazy">
											{% else %}
											<img style="border-radius: 50%;" src="{% static 'images/default-avatar.jpg' %}" alt="photo" loading="lazy">
											{% endif %}
										</figure> 

								<div class="comment-body">
									<div class="comment-rating ratings-container mb-0">
										<div class="ratings-full">
											
											<span class="ratings " style="width:{{ comment.rating|mul:20|floatformat:0  }}%"></span>
											
											<span class="tooltiptext tooltip-top">{{comment.rating}}</span>
										</div>
									</div>
									
									<div class="comment-user"  >
										<span class="comment-date text-body">{{comment.date_added}}</span>
										
										<h4>
											{% if comment.user.profile %}
											{{comment.user.profile.fullname}}
											{% else %}
												{{request.user.username}}
											{% endif %}
										</h4>
										
									</div>
									
									 
								
									<div class="comment-content">
										<p>{{comment.comment}}</p>
									</div>

									<div style="width: 50px; float: left;margin-right: 4px">
										{% if comment.image %}
										<a href="{{ comment.image.url }}">
											<img src="{{ comment.image.url }}">
										</a>
										{% endif %}
									</div>
									 
								</div>
							</div>
						</li>
						{% endfor %}
					</ul>
				</div>
				
					{% if request.user.is_authenticated %}

					<form method="POST" action="." enctype="multipart/form-data">
						{% csrf_token %}
					   <div class="reply ">
						   <div class="title-wrapper text-left">
							   <h3 class="title title-simple text-left text-normal {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %}">{% trans 'Ajouter' %}</h3>
						   </div>
						   <div class="rating-form {% if LANGUAGE_CODE == 'ar' %}flex-end{% endif %} ">
							{% if LANGUAGE_CODE == 'ar' %}
							
							<span class="rating-stars selected {% if LANGUAGE_CODE == 'ar' %}margin-right-30 ltr {% endif %}" required="required">
								<a class="star-1" href="#">1</a>
								<a class="star-2" href="#">2</a>
								<a class="star-3" href="#">3</a>
								<a class="star-4" href="#">4</a>
								<a class="star-5" href="#">5</a>
							</span>
							<label for="rating" class="text-dark rtl" required="required">{% trans 'Votre note' %} * </label>
							{% else %}
							<label for="rating" class="text-dark" required="required">{% trans 'Votre note' %} * </label>
							<span class="rating-stars selected   " required="required">
								<a class="star-1" href="#">1</a>
								<a class="star-2" href="#">2</a>
								<a class="star-3" href="#">3</a>
								<a class="star-4" href="#">4</a>
								<a class="star-5" href="#">5</a>
							</span>
							{% endif %}
							   
							   <select name="rating" id="rating" required="required" style="display: none;">
								   <option value="">Note...
								   </option><option value="5">Trés Bon
								   </option><option value="4">Bon
								   </option><option value="3">Normal
								   </option><option value="2">Pas Top
								   </option><option value="1">Mauvais
							   </option></select>
						   </div>
						   <!-- <input name="imagecom" type="file" id="comment_image" style="display: none;"> -->
						{{form.image}}
						<!-- <input type="file" name="com_img" style="display: none;" hidden="true" id="comment_image" accept="image/*" onchange="readUrl(this)" multiple="multiple"> -->
						<input style="display: none;" name="allcomimagesin_one" type="text" id="allcomimagesin_one" >
						   <div id="comment_img_list" class="comment_img_list" style="display: block ruby;position: absolute;bottom: 96px;left: 10px;">
								<!-- <div id="img_com1" class="img_com" style="width: 40px;
								height: 40px;
								margin-right: 5px;display: flex;">
									 
								</div> -->
							</div>
							   <textarea id="reply-message" name="text" cols="30" rows="6" class="form-control mb-4 {% if LANGUAGE_CODE == 'ar' %}rtl{% endif %} " placeholder="{% trans 'Commentaire *' %}" required="required">
								
							   </textarea>											
							   <input type="text" hidden="true" name="findslug" value="{{object.slug}}"> 
							   

							   
							   <div class="form-checkbox mb-4">
								   <input type="checkbox" class="custom-checkbox" id="signin-remember" name="signin-remember">
							   </div>
						   </div>
						   <button type="button" id="btnuplo" style="background-color: forestgreen;border: none;outline: none;" type="submit" class="btn   btn-rounded">
							
							<img style="height: 21px;scale: 1.6;margin-right: 8px;
							cursor: pointer;"  src="{% static 'images/upload_icon.png' %}" alt="">
							   {% trans 'Upload image' %}
						   </button>
						   
							   <button type="submit" class="btn btn-primary btn-rounded">{% trans 'Confirmer' %}</button>
							   <script>
								       function readUrl(input) {
  if (input.files && input.files[0]) {
    let reader = new FileReader();
    reader.onload = (e) => {
      let imgData = e.target.result;
      let imgName = input.files[0].name;
      input.setAttribute("data-title", imgName);
     
    };
    reader.readAsDataURL(input.files[0]);
  }
}
								document.getElementById("btnuplo").addEventListener("click",function(e){
									e.preventDefault();
									document.getElementById('comment_image').click()
								})
								var allcomimagesin_one= document.getElementById("allcomimagesin_one")
								var imageInput = document.getElementById("comment_image")
								var imageContainer = document.getElementById("comment_img_list")
								console.log(imageContainer)
								imageInput.addEventListener('change', function(event) {
								const selectedFile = event.target.files[0]; // Get the selected file
								if (selectedFile) {
									// Set the src attribute of the image to the selected file's URL
									const newImage = document.createElement('img');
									newImage.src = URL.createObjectURL(selectedFile);
									newImage.alt = 'Uploaded Image';
									// newImage.style.marginRight=5+"px"
									const newDiv = document.createElement('div');
									newDiv.id = `img_com1`;
									newDiv.className = 'img_com';
									newDiv.style.width = '40px';
									newDiv.style.height = '40px';
									newDiv.style.marginRight = '5px';
									newDiv.style.display = 'flex';
									newDiv.appendChild(newImage);
									imageContainer.appendChild(newDiv);
									allcomimagesin_one.value=""
									// gather all images in one array
									allcomimagesin_one.value  = imageInput.value + ","
									 
								}
								});
							 </script>  
					   </form>
					{% else %}
					<a href="/login"> <span style="font-weight:bold;">Connectez-vous</span> pour rédiger un commentaire.</a>
					{% endif %}
			</div>
		</div>
	</div>
	<!-- Footer -->
	



	<!-- Back to top -->
	

	<!-- Container Selection -->
	<div id="dropDownSelect1"></div>
	<div id="dropDownSelect2"></div>
	<script>

		Array.from(document.getElementsByClassName("taille__wrapper")).forEach(ele=>{
            ele.addEventListener("click",()=>{
				Array.from(document.querySelector("#sticky_sizes").children).forEach(child=>{
					 
					if (child.value == ele.children[1].textContent.trim()) {
						child.selected = true;
						 
					}
				})
                
            })
        })




		var varowl=document.getElementsByClassName("variant-owl")
		varowl = Array.from(varowl)
		varowl.forEach(ele=>{
			if(window.location.pathname.includes(ele.dataset.slug)){
				ele.classList.add("variant-owl-active")
			}
		})

		if(document.querySelector(".variants-parent")){
			const parentContainer  = document.querySelector(".variants-parent");
      // Initialize variables to store the starting position of the drag
    var startX;

	// Add event listeners to the parent container
	parentContainer.addEventListener("mousedown", function(event) {
		// Store the starting position of the drag
		startX = event.clientX - parentContainer.scrollLeft;
		 
		parentContainer.addEventListener("mousemove", function(event) {
		// Calculate the distance dragged horizontally
		var x = event.clientX - startX;
		 
		// Scroll the parent container horizontally by the calculated distance
		parentContainer.scrollLeft = -x;
	});
	parentContainer.addEventListener("mouseup", function() {
		// Reset the starting position of the drag
		startX = startX;
		 
	});
	});

	

	parentContainer.addEventListener("mouseup", function() {
		// Reset the starting position of the drag
		startX = 0;
		console.log(startX)
	});


		}
	
     
       
       


document.addEventListener("DOMContentLoaded", function() {
    // Get the navbar element
    var navbar = document.querySelector(".sticky-content");

    // Calculate the position where the navbar should become sticky
    
	var productQtyElement = document.querySelectorAll(".product-qty")[0];
	var productQtyElement1 = document.querySelectorAll(".sticky-content")[0];
	
	var stickyPosition = productQtyElement.offsetTop;
    function updateStickyNavbar () {
        if (window.pageYOffset >= stickyPosition + 250) {
            navbar.classList.remove("display-none");
			productQtyElement1.classList.add("fix-top")
			 
        } else {
            navbar.classList.add("display-none");
			productQtyElement1.classList.remove("fix-top")
			 
        }
    }

    // Listen for scroll events and update the navbar
    window.addEventListener("scroll", updateStickyNavbar);

    // Update the sticky navbar on page load
    updateStickyNavbar();


	var productthumb = document.getElementsByClassName("product-thumb")
							productthumb = Array.from(productthumb)
							
							productthumb.forEach(ele=>{
								ele.addEventListener("click",function(){
									
									var slickcurrent = document.getElementsByClassName("slick-current slick-active")[0]
									var main_img_src = slickcurrent.children[0].children[1].getAttribute("href")
									var src_target = this.children[0].getAttribute("src");
									console.log(slickcurrent.children[0].children[1])
									
									slickcurrent.children[0].children[1].href =src_target;
									slickcurrent.children[0].children[1].children[0].src =src_target;
									 
								})
							}) 
});

		 


		Array.from(document.querySelectorAll("#submit_to")).forEach(ele=>{

			ele.addEventListener("click",function(e){
			e.preventDefault()
			var targetsize= document.querySelector(".variant-input:checked").nextElementSibling.textContent.trim()
			document.getElementById("submit_to").href = this.href.replace("name=dd","search="+targetsize)
			  
			window.location = document.getElementById("submit_to").href
			 
		})

		})
		
		

		Array.from(document.querySelectorAll(".rating-stars a")).forEach(aele=>{
			aele.addEventListener("click",function(e){
			e.preventDefault()
			var selectElement=document.getElementById("rating")
			var desiredValue=this.classList[0].split("-")[1]
			for (var i = 0; i < selectElement.options.length; i++) {
			if (selectElement.options[i].value === desiredValue) {
				selectElement.options[i].selected = true; // Set the option as selected
				break; // Exit the loop once the desired option is found
			}
			}
			$(this).siblings().removeClass("active")
			this.classList.add('active')
		})
		})
		
	</script>
	

	{% endblock content %}